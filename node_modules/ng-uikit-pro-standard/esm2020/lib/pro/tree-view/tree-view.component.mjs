import { coerceBooleanProperty } from '@angular/cdk/coercion';
import { Component, Input, Output, EventEmitter, ViewEncapsulation, ChangeDetectionStrategy, HostBinding, } from '@angular/core';
import { SPACE, ENTER } from '../../free/utils/keyboard-navigation';
import * as i0 from "@angular/core";
import * as i1 from "../../free/checkbox/checkbox.component";
import * as i2 from "@angular/common";
export class MdbTreeComponent {
    constructor(_cdRef) {
        this._cdRef = _cdRef;
        this.checked = new EventEmitter();
        this.checkedKeys = new EventEmitter();
        this.nodesChanged = new EventEmitter();
        this._checkboxes = false;
        this._toggleOnTitleClick = false;
        this._expandAll = false;
        this.checkedValues = [];
        this.toggle = {};
    }
    set expandAll(v) {
        const value = coerceBooleanProperty(v);
        if (this.nodes && this.nodes.entries()) {
            this._expandAll = value;
            this.toggleExpandAll();
        }
    }
    get checkboxes() {
        return this._checkboxes;
    }
    set checkboxes(value) {
        this._checkboxes = coerceBooleanProperty(value);
    }
    get toggleOnTitleClick() {
        return this._toggleOnTitleClick;
    }
    set toggleOnTitleClick(value) {
        this._toggleOnTitleClick = coerceBooleanProperty(value);
    }
    ngOnInit() {
        if (this.nodes && this.nodes.entries()) {
            this._setInitialCheckedKeys();
        }
    }
    toggleExpandAll() {
        if (this._expandAll) {
            this.expandAllNodes();
        }
        else if (!this._expandAll) {
            this.closeAllNodes();
        }
    }
    expandAllNodes() {
        for (const [index, node] of this.nodes.entries()) {
            const idx = index;
            this.toggle[idx] = true;
            if (node[this.childrenField] && node[this.childrenField].length > 0) {
                this._expandAllChildren(node, idx);
            }
        }
    }
    closeAllNodes() {
        for (const [index, node] of this.nodes.entries()) {
            const idx = index;
            this.toggle[idx] = false;
            if (node[this.childrenField] && node[this.childrenField].length > 0) {
                this._closeAllChildren(node, idx);
            }
        }
    }
    _expandAllChildren(node, idx) {
        for (const [childIndex, childNode] of node[this.childrenField].entries()) {
            const childIdx = idx + '_' + childIndex;
            this.toggle[childIdx] = true;
            if (childNode[this.childrenField] && childNode[this.childrenField].length > 0) {
                this._expandAllChildren(childNode, childIdx);
            }
        }
    }
    _closeAllChildren(node, idx) {
        for (const [childIndex, childNode] of node[this.childrenField].entries()) {
            const childIdx = idx + '_' + childIndex;
            this.toggle[childIdx] = false;
            if (childNode[this.childrenField] && childNode[this.childrenField].length > 0) {
                this._closeAllChildren(childNode, childIdx);
            }
        }
    }
    _setInitialCheckedKeys() {
        for (const [index, node] of this.nodes.entries()) {
            if (node[this.checkboxesField]) {
                const idx = index;
                this.checkedValues.push(idx);
                if (node[this.childrenField] && node[this.childrenField].length > 0) {
                    this._hasInitialCheckedKeysChildren(node[this.childrenField], idx);
                }
            }
        }
    }
    _hasInitialCheckedKeysChildren(childrenNode, i) {
        for (const [childrenIdx, node] of childrenNode.entries()) {
            const idx = childrenIdx + '_' + i;
            if (node[this.checkboxesField]) {
                this.checkedValues.push(idx);
            }
            if (node[this.childrenField] && node[this.childrenField].length > 0) {
                this._hasInitialCheckedKeysChildren(node[this.childrenField], idx);
            }
        }
    }
    toggleByNode(i) {
        for (const [index, node] of this.nodes.entries()) {
            if (node[this.childrenField] && node[this.childrenField].length > 0) {
                const idx = index;
                const toggleIdx = i;
                if (idx === toggleIdx) {
                    this.toggle[idx] = !this.toggle[idx];
                    this._cdRef.markForCheck();
                }
                else {
                    this._childrenToggleByNode(node, idx, toggleIdx);
                }
            }
        }
    }
    _childrenToggleByNode(node, i, toggleIdx) {
        for (const [childIndex, childNode] of node[this.childrenField].entries()) {
            const nodeHasChildren = childNode[this.childrenField] && childNode[this.childrenField].length > 0;
            if (nodeHasChildren) {
                const idx = i + '_' + childIndex;
                if (idx === toggleIdx) {
                    this.toggle[idx] = !this.toggle[idx];
                    this._cdRef.markForCheck();
                }
                else {
                    this._childrenToggleByNode(childNode, idx, toggleIdx);
                }
            }
            else {
                return;
            }
        }
    }
    onKeydownCheckbox(e, node, i) {
        if (e.keyCode === SPACE || e.keyCode === ENTER) {
            e.preventDefault();
            this.checkNodes(node);
            this.updateNodesCheckedValues(node, i);
        }
    }
    onKeydown(e, i) {
        if (e.keyCode === SPACE || e.keyCode === ENTER) {
            e.preventDefault();
            this.toggle[i] = !this.toggle[i];
        }
    }
    checkNodes(node) {
        setTimeout(() => {
            node[this.checkboxesField] = !node[this.checkboxesField];
            this.checked.emit(node);
            this.nodesChanged.emit(this.nodes);
        }, 0);
        const nodeHasChildren = node[this.childrenField] && node[this.childrenField].length > 0;
        if (nodeHasChildren) {
            this._checkChildNodes(node[this.childrenField], !node[this.checkboxesField]);
        }
        this._cdRef.markForCheck();
    }
    _checkChildNodes(children, checked) {
        children.forEach((childNode) => {
            if (childNode[this.checkboxesField] !== undefined) {
                childNode[this.checkboxesField] = checked;
                const nodeHasChildren = childNode[this.childrenField] && childNode[this.childrenField].length > 0;
                if (nodeHasChildren) {
                    this._checkChildNodes(childNode[this.childrenField], checked);
                }
            }
        });
    }
    updateNodesCheckedValues(node, idx) {
        setTimeout(() => {
            if (node[this.checkboxesField] && !this.checkedValues.includes(idx)) {
                this.checkedValues.push(idx);
            }
            else if (!node[this.checkboxesField] && this.checkedValues.includes(idx)) {
                const removeIndex = this.checkedValues.findIndex((e) => e === idx);
                if (removeIndex !== -1) {
                    this.checkedValues.splice(removeIndex, 1);
                }
            }
            const nodeHasChildren = node[this.childrenField] && node[this.childrenField].length > 0;
            if (nodeHasChildren) {
                this._updateChildNodesCheckedValues(node[this.childrenField], idx);
            }
            this.checkedKeys.emit(this.checkedValues);
        }, 0);
    }
    _updateChildNodesCheckedValues(childrenNode, childrenIdx) {
        for (const [index, node] of childrenNode.entries()) {
            const idx = childrenIdx + '_' + index;
            if (node[this.checkboxesField] && !this.checkedValues.includes(idx)) {
                this.checkedValues.push(idx);
            }
            else if (!node[this.checkboxesField] && this.checkedValues.includes(idx)) {
                const removeIndex = this.checkedValues.findIndex((e) => e === idx);
                if (removeIndex !== -1) {
                    this.checkedValues.splice(removeIndex, 1);
                }
            }
            const nodeHasChildren = node[this.childrenField] && node[this.childrenField].length > 0;
            if (nodeHasChildren) {
                this._updateChildNodesCheckedValues(node[this.childrenField], idx);
            }
        }
    }
}
MdbTreeComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "13.2.7", ngImport: i0, type: MdbTreeComponent, deps: [{ token: i0.ChangeDetectorRef }], target: i0.ɵɵFactoryTarget.Component });
MdbTreeComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "12.0.0", version: "13.2.7", type: MdbTreeComponent, selector: "mdb-tree", inputs: { nodes: "nodes", textField: "textField", childrenField: "childrenField", checkboxesField: "checkboxesField", expandAll: "expandAll", checkboxes: "checkboxes", toggleOnTitleClick: "toggleOnTitleClick" }, outputs: { checked: "checked", checkedKeys: "checkedKeys", nodesChanged: "nodesChanged" }, host: { properties: { "class.mdb-tree": "this.checked" } }, ngImport: i0, template: "<!-- child nodes -->\n<ng-template #tree let-nodeChildren let-idx=\"idx\">\n  <ul class=\"mdb-tree-list\">\n    <li *ngFor=\"let node of nodeChildren; let n = index\" class=\"mdb-tree-list-node\">\n      <div class=\"mdb-tree-container\">\n        <div *ngIf=\"node[childrenField] && node[childrenField].length > 0; else emptyIcon\">\n          <span class=\"mdb-tree-icon-container\">\n            <i\n              tabindex=\"1\"\n              aria-hidden=\"true\"\n              [ngClass]=\"\n                toggle[idx + '_' + n] ? 'mdb-tree-rotate-icon-open' : 'mdb-tree-rotate-icon-closed'\n              \"\n              (keydown)=\"onKeydown($event, idx + '_' + n)\"\n              (click)=\"toggle[idx + '_' + n] = !toggle[idx + '_' + n]\"\n              class=\"mdb-tree-indicator \"\n            ></i>\n          </span>\n        </div>\n        <ng-template #emptyIcon\n          ><span class=\"mdb-tree-icon-container\"\n            ><i class=\"mdb-tree-empty-icon\" style=\"display: block\" aria-hidden=\"true\"></i\n          ></span>\n        </ng-template>\n        <div\n          class=\"mdb-tree-checkbox-container\"\n          *ngIf=\"checkboxes && node[checkboxesField] !== undefined\"\n        >\n          <mdb-checkbox\n            class=\"checkbox-filled\"\n            [filledIn]=\"true\"\n            [tabIndex]=\"1\"\n            [attr.id]=\"node[textField]\"\n            (keydown)=\"onKeydownCheckbox($event, node, idx + '_' + n)\"\n            (click)=\"checkNodes(node); updateNodesCheckedValues(node, idx + '_' + n)\"\n            [checked]=\"node[checkboxesField]\"\n          ></mdb-checkbox>\n        </div>\n        <div *ngIf=\"checkboxes && node[checkboxesField] === undefined\">\n          <div class=\"mdb-tree-checkbox-null-container\"></div>\n        </div>\n\n        <div\n          *ngIf=\"toggleOnTitleClick\"\n          class=\"mdb-tree-text-field\"\n          [ngStyle]=\"{\n            cursor: node[childrenField] && node[childrenField].length > 0 ? 'pointer' : 'default'\n          }\"\n          (click)=\"toggle[idx + '_' + n] = !toggle[idx + '_' + n]\"\n        >\n          {{ node[textField] }}\n        </div>\n\n        <div *ngIf=\"!toggleOnTitleClick\" class=\"mdb-tree-text-field mdb-tree-text-ellipsis\">\n          {{ node[textField] }}\n        </div>\n      </div>\n      <div *ngIf=\"node[childrenField] && toggle[idx + '_' + n]\">\n        <ng-container\n          *ngTemplateOutlet=\"tree; context: { $implicit: node[childrenField], idx: idx + '_' + n }\"\n        ></ng-container>\n      </div>\n    </li>\n  </ul>\n</ng-template>\n<!-- first nodes -->\n<ul class=\"mdb-tree-list\">\n  <li *ngFor=\"let node of nodes; let i = index\" class=\"mdb-tree-list-node\">\n    <div class=\"mdb-tree-container\">\n      <div *ngIf=\"node[childrenField] && node[childrenField].length > 0; else emptyIcon\">\n        <span class=\"mdb-tree-icon-container\">\n          <i\n            tabindex=\"1\"\n            aria-hidden=\"true\"\n            [ngClass]=\"toggle[i] ? 'mdb-tree-rotate-icon-open' : 'mdb-tree-rotate-icon-closed'\"\n            (keydown)=\"onKeydown($event, i)\"\n            (click)=\"toggle[i] = !toggle[i]\"\n            class=\"mdb-tree-indicator\"\n          ></i>\n        </span>\n      </div>\n      <ng-template #emptyIcon\n        ><span class=\"mdb-tree-icon-container\"\n          ><i class=\"mdb-tree-empty-icon\" style=\"display: block\" aria-hidden=\"true\"></i\n        ></span>\n      </ng-template>\n      <div\n        class=\"mdb-tree-checkbox-container\"\n        *ngIf=\"checkboxes && node[checkboxesField] !== undefined\"\n      >\n        <mdb-checkbox\n          class=\"checkbox-filled\"\n          [checked]=\"node[checkboxesField]\"\n          [filledIn]=\"true\"\n          [tabIndex]=\"1\"\n          [attr.id]=\"node[textField]\"\n          (keydown)=\"onKeydownCheckbox($event, node, i)\"\n          (click)=\"checkNodes(node); updateNodesCheckedValues(node, i)\"\n        ></mdb-checkbox>\n      </div>\n      <div *ngIf=\"checkboxes && node[checkboxesField] === undefined\">\n        <div class=\"mdb-tree-checkbox-null-container\"></div>\n      </div>\n\n      <div\n        *ngIf=\"toggleOnTitleClick\"\n        class=\"mdb-tree-text-field\"\n        [ngStyle]=\"{\n          cursor: node[childrenField] && node[childrenField].length > 0 ? 'pointer' : 'default'\n        }\"\n        (click)=\"toggle[i] = !toggle[i]\"\n      >\n        {{ node[textField] }}\n      </div>\n\n      <div *ngIf=\"!toggleOnTitleClick\" class=\"mdb-tree-text-field mdb-tree-text-ellipsis\">\n        {{ node[textField] }}\n      </div>\n    </div>\n    <div *ngIf=\"node[childrenField] && toggle[i]\">\n      <ng-container\n        *ngTemplateOutlet=\"tree; context: { $implicit: node[childrenField], idx: i }\"\n      ></ng-container>\n    </div>\n  </li>\n</ul>\n", styles: [".mdb-tree-list{list-style-type:none;margin:0;padding:0}.mdb-tree-list-node{list-style-type:none;margin:.8rem .8rem .8rem .95rem}.mdb-tree-container{display:flex;min-width:230px}.mdb-tree-icon-container{display:inline-block;width:2rem;height:auto}.mdb-tree-empty-icon{cursor:default}.mdb-tree-text-field{margin-top:.15rem;max-width:90%;text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.mdb-tree-checkbox-null-container{min-width:2.2rem}.mdb-tree-indicator{position:relative;right:0;transform-origin:50% 79%;margin-right:.8rem;display:inline-block;margin-right:0rem;margin-top:.025rem;cursor:pointer;font-size:1.3rem}.mdb-tree-indicator:after{content:\"\";display:block;border-style:solid;padding:5px;margin-top:.15rem;border-width:0 3px 3px 0;font-size:1.3rem;transform:rotate(45deg)}.mdb-tree-indicator:focus{color:#4285f4}.mdb-tree-indicator:focus{outline:none}.mdb-tree-rotate-icon-open{transform:rotate(0)}.mdb-tree-rotate-icon-closed{transform:rotate(270deg)}.mdb-tree-checkbox-container{margin-top:.25rem}.mdb-tree-checkbox-container mdb-checkbox.checkbox-filled [type=checkbox][class*=filled-in]:checked+label:after{border-color:#4285f4;background-color:#4285f4}\n"], components: [{ type: i1.CheckboxComponent, selector: "mdb-checkbox", inputs: ["class", "checkboxId", "required", "name", "value", "checked", "filledIn", "indeterminate", "disabled", "rounded", "checkboxPosition", "default", "inline", "tabIndex"], outputs: ["change"] }], directives: [{ type: i2.NgForOf, selector: "[ngFor][ngForOf]", inputs: ["ngForOf", "ngForTrackBy", "ngForTemplate"] }, { type: i2.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { type: i2.NgClass, selector: "[ngClass]", inputs: ["class", "ngClass"] }, { type: i2.NgStyle, selector: "[ngStyle]", inputs: ["ngStyle"] }, { type: i2.NgTemplateOutlet, selector: "[ngTemplateOutlet]", inputs: ["ngTemplateOutletContext", "ngTemplateOutlet"] }], changeDetection: i0.ChangeDetectionStrategy.OnPush, encapsulation: i0.ViewEncapsulation.None });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "13.2.7", ngImport: i0, type: MdbTreeComponent, decorators: [{
            type: Component,
            args: [{ selector: 'mdb-tree', encapsulation: ViewEncapsulation.None, changeDetection: ChangeDetectionStrategy.OnPush, template: "<!-- child nodes -->\n<ng-template #tree let-nodeChildren let-idx=\"idx\">\n  <ul class=\"mdb-tree-list\">\n    <li *ngFor=\"let node of nodeChildren; let n = index\" class=\"mdb-tree-list-node\">\n      <div class=\"mdb-tree-container\">\n        <div *ngIf=\"node[childrenField] && node[childrenField].length > 0; else emptyIcon\">\n          <span class=\"mdb-tree-icon-container\">\n            <i\n              tabindex=\"1\"\n              aria-hidden=\"true\"\n              [ngClass]=\"\n                toggle[idx + '_' + n] ? 'mdb-tree-rotate-icon-open' : 'mdb-tree-rotate-icon-closed'\n              \"\n              (keydown)=\"onKeydown($event, idx + '_' + n)\"\n              (click)=\"toggle[idx + '_' + n] = !toggle[idx + '_' + n]\"\n              class=\"mdb-tree-indicator \"\n            ></i>\n          </span>\n        </div>\n        <ng-template #emptyIcon\n          ><span class=\"mdb-tree-icon-container\"\n            ><i class=\"mdb-tree-empty-icon\" style=\"display: block\" aria-hidden=\"true\"></i\n          ></span>\n        </ng-template>\n        <div\n          class=\"mdb-tree-checkbox-container\"\n          *ngIf=\"checkboxes && node[checkboxesField] !== undefined\"\n        >\n          <mdb-checkbox\n            class=\"checkbox-filled\"\n            [filledIn]=\"true\"\n            [tabIndex]=\"1\"\n            [attr.id]=\"node[textField]\"\n            (keydown)=\"onKeydownCheckbox($event, node, idx + '_' + n)\"\n            (click)=\"checkNodes(node); updateNodesCheckedValues(node, idx + '_' + n)\"\n            [checked]=\"node[checkboxesField]\"\n          ></mdb-checkbox>\n        </div>\n        <div *ngIf=\"checkboxes && node[checkboxesField] === undefined\">\n          <div class=\"mdb-tree-checkbox-null-container\"></div>\n        </div>\n\n        <div\n          *ngIf=\"toggleOnTitleClick\"\n          class=\"mdb-tree-text-field\"\n          [ngStyle]=\"{\n            cursor: node[childrenField] && node[childrenField].length > 0 ? 'pointer' : 'default'\n          }\"\n          (click)=\"toggle[idx + '_' + n] = !toggle[idx + '_' + n]\"\n        >\n          {{ node[textField] }}\n        </div>\n\n        <div *ngIf=\"!toggleOnTitleClick\" class=\"mdb-tree-text-field mdb-tree-text-ellipsis\">\n          {{ node[textField] }}\n        </div>\n      </div>\n      <div *ngIf=\"node[childrenField] && toggle[idx + '_' + n]\">\n        <ng-container\n          *ngTemplateOutlet=\"tree; context: { $implicit: node[childrenField], idx: idx + '_' + n }\"\n        ></ng-container>\n      </div>\n    </li>\n  </ul>\n</ng-template>\n<!-- first nodes -->\n<ul class=\"mdb-tree-list\">\n  <li *ngFor=\"let node of nodes; let i = index\" class=\"mdb-tree-list-node\">\n    <div class=\"mdb-tree-container\">\n      <div *ngIf=\"node[childrenField] && node[childrenField].length > 0; else emptyIcon\">\n        <span class=\"mdb-tree-icon-container\">\n          <i\n            tabindex=\"1\"\n            aria-hidden=\"true\"\n            [ngClass]=\"toggle[i] ? 'mdb-tree-rotate-icon-open' : 'mdb-tree-rotate-icon-closed'\"\n            (keydown)=\"onKeydown($event, i)\"\n            (click)=\"toggle[i] = !toggle[i]\"\n            class=\"mdb-tree-indicator\"\n          ></i>\n        </span>\n      </div>\n      <ng-template #emptyIcon\n        ><span class=\"mdb-tree-icon-container\"\n          ><i class=\"mdb-tree-empty-icon\" style=\"display: block\" aria-hidden=\"true\"></i\n        ></span>\n      </ng-template>\n      <div\n        class=\"mdb-tree-checkbox-container\"\n        *ngIf=\"checkboxes && node[checkboxesField] !== undefined\"\n      >\n        <mdb-checkbox\n          class=\"checkbox-filled\"\n          [checked]=\"node[checkboxesField]\"\n          [filledIn]=\"true\"\n          [tabIndex]=\"1\"\n          [attr.id]=\"node[textField]\"\n          (keydown)=\"onKeydownCheckbox($event, node, i)\"\n          (click)=\"checkNodes(node); updateNodesCheckedValues(node, i)\"\n        ></mdb-checkbox>\n      </div>\n      <div *ngIf=\"checkboxes && node[checkboxesField] === undefined\">\n        <div class=\"mdb-tree-checkbox-null-container\"></div>\n      </div>\n\n      <div\n        *ngIf=\"toggleOnTitleClick\"\n        class=\"mdb-tree-text-field\"\n        [ngStyle]=\"{\n          cursor: node[childrenField] && node[childrenField].length > 0 ? 'pointer' : 'default'\n        }\"\n        (click)=\"toggle[i] = !toggle[i]\"\n      >\n        {{ node[textField] }}\n      </div>\n\n      <div *ngIf=\"!toggleOnTitleClick\" class=\"mdb-tree-text-field mdb-tree-text-ellipsis\">\n        {{ node[textField] }}\n      </div>\n    </div>\n    <div *ngIf=\"node[childrenField] && toggle[i]\">\n      <ng-container\n        *ngTemplateOutlet=\"tree; context: { $implicit: node[childrenField], idx: i }\"\n      ></ng-container>\n    </div>\n  </li>\n</ul>\n", styles: [".mdb-tree-list{list-style-type:none;margin:0;padding:0}.mdb-tree-list-node{list-style-type:none;margin:.8rem .8rem .8rem .95rem}.mdb-tree-container{display:flex;min-width:230px}.mdb-tree-icon-container{display:inline-block;width:2rem;height:auto}.mdb-tree-empty-icon{cursor:default}.mdb-tree-text-field{margin-top:.15rem;max-width:90%;text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.mdb-tree-checkbox-null-container{min-width:2.2rem}.mdb-tree-indicator{position:relative;right:0;transform-origin:50% 79%;margin-right:.8rem;display:inline-block;margin-right:0rem;margin-top:.025rem;cursor:pointer;font-size:1.3rem}.mdb-tree-indicator:after{content:\"\";display:block;border-style:solid;padding:5px;margin-top:.15rem;border-width:0 3px 3px 0;font-size:1.3rem;transform:rotate(45deg)}.mdb-tree-indicator:focus{color:#4285f4}.mdb-tree-indicator:focus{outline:none}.mdb-tree-rotate-icon-open{transform:rotate(0)}.mdb-tree-rotate-icon-closed{transform:rotate(270deg)}.mdb-tree-checkbox-container{margin-top:.25rem}.mdb-tree-checkbox-container mdb-checkbox.checkbox-filled [type=checkbox][class*=filled-in]:checked+label:after{border-color:#4285f4;background-color:#4285f4}\n"] }]
        }], ctorParameters: function () { return [{ type: i0.ChangeDetectorRef }]; }, propDecorators: { checked: [{
                type: HostBinding,
                args: ['class.mdb-tree']
            }, {
                type: Output
            }], checkedKeys: [{
                type: Output
            }], nodesChanged: [{
                type: Output
            }], nodes: [{
                type: Input
            }], textField: [{
                type: Input
            }], childrenField: [{
                type: Input
            }], checkboxesField: [{
                type: Input
            }], expandAll: [{
                type: Input
            }], checkboxes: [{
                type: Input
            }], toggleOnTitleClick: [{
                type: Input
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidHJlZS12aWV3LmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL25nLXVpa2l0LXByby1zdGFuZGFyZC9zcmMvbGliL3Byby90cmVlLXZpZXcvdHJlZS12aWV3LmNvbXBvbmVudC50cyIsIi4uLy4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL25nLXVpa2l0LXByby1zdGFuZGFyZC9zcmMvbGliL3Byby90cmVlLXZpZXcvdHJlZS12aWV3LmNvbXBvbmVudC5odG1sIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBZ0IscUJBQXFCLEVBQUUsTUFBTSx1QkFBdUIsQ0FBQztBQUM1RSxPQUFPLEVBQ0wsU0FBUyxFQUNULEtBQUssRUFDTCxNQUFNLEVBQ04sWUFBWSxFQUVaLGlCQUFpQixFQUNqQix1QkFBdUIsRUFFdkIsV0FBVyxHQUNaLE1BQU0sZUFBZSxDQUFDO0FBRXZCLE9BQU8sRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLE1BQU0sc0NBQXNDLENBQUM7Ozs7QUFTcEUsTUFBTSxPQUFPLGdCQUFnQjtJQTBDM0IsWUFBb0IsTUFBeUI7UUFBekIsV0FBTSxHQUFOLE1BQU0sQ0FBbUI7UUF2QzdDLFlBQU8sR0FBRyxJQUFJLFlBQVksRUFBRSxDQUFDO1FBQ25CLGdCQUFXLEdBQUcsSUFBSSxZQUFZLEVBQUUsQ0FBQztRQUNqQyxpQkFBWSxHQUFHLElBQUksWUFBWSxFQUFFLENBQUM7UUFzQnBDLGdCQUFXLEdBQUcsS0FBSyxDQUFDO1FBU3BCLHdCQUFtQixHQUFHLEtBQUssQ0FBQztRQUU1QixlQUFVLEdBQUcsS0FBSyxDQUFDO1FBQzNCLGtCQUFhLEdBQWEsRUFBRSxDQUFDO1FBQzdCLFdBQU0sR0FBUSxFQUFFLENBQUM7SUFFK0IsQ0FBQztJQS9CakQsSUFBYSxTQUFTLENBQUMsQ0FBZTtRQUNwQyxNQUFNLEtBQUssR0FBRyxxQkFBcUIsQ0FBQyxDQUFDLENBQUMsQ0FBQztR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QzNDO2FBQ0Y7WUFDRCxNQUFNLGVBQWUsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxJQUFJLElBQUksQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQztZQUN4RixJQUFJLGVBQWUsRUFBRTtnQkFDbkIsSUFBSSxDQUFDLDhCQUE4QixDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLEVBQUUsR0FBRyxDQUFDLENBQUM7YUFDcEU7U0FDRjtJQUNILENBQUM7OzZHQXpPVSxnQkFBZ0I7aUdBQWhCLGdCQUFnQiwyWkN0QjdCLDh2SkE4SEE7MkZEeEdhLGdCQUFnQjtrQkFSNUIsU0FBUzsrQkFFRSxVQUFVLGlCQUdMLGlCQUFpQixDQUFDLElBQUksbUJBQ3BCLHVCQUF1QixDQUFDLE1BQU07d0dBSy9DLE9BQU87c0JBRk4sV0FBVzt1QkFBQyxnQkFBZ0I7O3NCQUM1QixNQUFNO2dCQUVHLFdBQVc7c0JBQXBCLE1BQU07Z0JBQ0csWUFBWTtzQkFBckIsTUFBTTtnQkFDRSxLQUFLO3NCQUFiLEtBQUs7Z0JBQ0csU0FBUztzQkFBakIsS0FBSztnQkFDRyxhQUFhO3NCQUFyQixLQUFLO2dCQUNHLGVBQWU7c0JBQXZCLEtBQUs7Z0JBRU8sU0FBUztzQkFBckIsS0FBSztnQkFVRixVQUFVO3NCQURiLEtBQUs7Z0JBVUYsa0JBQWtCO3NCQURyQixLQUFLIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQm9vbGVhbklucHV0LCBjb2VyY2VCb29sZWFuUHJvcGVydHkgfSBmcm9tICdAYW5ndWxhci9jZGsvY29lcmNpb24nO1xuaW1wb3J0IHtcbiAgQ29tcG9uZW50LFxuICBJbnB1dCxcbiAgT3V0cHV0LFxuICBFdmVudEVtaXR0ZXIsXG4gIE9uSW5pdCxcbiAgVmlld0VuY2Fwc3VsYXRpb24sXG4gIENoYW5nZURldGVjdGlvblN0cmF0ZWd5LFxuICBDaGFuZ2VEZXRlY3RvclJlZixcbiAgSG9zdEJpbmRpbmcsXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuXG5pbXBvcnQgeyBTUEFDRSwgRU5URVIgfSBmcm9tICcuLi8uLi9mcmVlL3V0aWxzL2tleWJvYXJkLW5hdmlnYXRpb24nO1xuQENvbXBvbmVudCh7XG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAYW5ndWxhci1lc2xpbnQvY29tcG9uZW50LXNlbGVjdG9yXG4gIHNlbGVjdG9yOiAnbWRiLXRyZWUnLFxuICB0ZW1wbGF0ZVVybDogJy4vdHJlZS12aWV3LmNvbXBvbmVudC5odG1sJyxcbiAgc3R5bGVVcmxzOiBbJy4vdHJlZS12aWV3LmNvbXBvbmVudC5zY3NzJ10sXG4gIGVuY2Fwc3VsYXRpb246IFZpZXdFbmNhcHN1bGF0aW9uLk5vbmUsXG4gIGNoYW5nZURldGVjdGlvbjogQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3kuT25QdXNoLFxufSlcbmV4cG9ydCBjbGFzcyBNZGJUcmVlQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcbiAgQEhvc3RCaW5kaW5nKCdjbGFzcy5tZGItdHJlZScpXG4gIEBPdXRwdXQoKVxuICBjaGVja2VkID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICBAT3V0cHV0KCkgY2hlY2tlZEtleXMgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gIEBPdXRwdXQoKSBub2Rlc0NoYW5nZWQgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gIEBJbnB1dCgpIG5vZGVzOiBhbnk7XG4gIEBJbnB1dCgpIHRleHRGaWVsZDogc3RyaW5nO1xuICBASW5wdXQoKSBjaGlsZHJlbkZpZWxkOiBzdHJpbmc7XG4gIEBJbnB1dCgpIGNoZWNrYm94ZXNGaWVsZDogc3RyaW5nO1xuXG4gIEBJbnB1dCgpIHNldCBleHBhbmRBbGwodjogQm9vbGVhbklucHV0KSB7XG4gICAgY29uc3QgdmFsdWUgPSBjb2VyY2VCb29sZWFuUHJvcGVydHkodik7XG5cbiAgICBpZiAodGhpcy5ub2RlcyAmJiB0aGlzLm5vZGVzLmVudHJpZXMoKSkge1xuICAgICAgdGhpcy5fZXhwYW5kQWxsID0gdmFsdWU7XG4gICAgICB0aGlzLnRvZ2dsZUV4cGFuZEFsbCgpO1xuICAgIH1cbiAgfVxuXG4gIEBJbnB1dCgpXG4gIGdldCBjaGVja2JveGVzKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLl9jaGVja2JveGVzO1xuICB9XG4gIHNldCBjaGVja2JveGVzKHZhbHVlOiBCb29sZWFuSW5wdXQpIHtcbiAgICB0aGlzLl9jaGVja2JveGVzID0gY29lcmNlQm9vbGVhblByb3BlcnR5KHZhbHVlKTtcbiAgfVxuICBwcml2YXRlIF9jaGVja2JveGVzID0gZmFsc2U7XG5cbiAgQElucHV0KClcbiAgZ2V0IHRvZ2dsZU9uVGl0bGVDbGljaygpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5fdG9nZ2xlT25UaXRsZUNsaWNrO1xuICB9XG4gIHNldCB0b2dnbGVPblRpdGxlQ2xpY2sodmFsdWU6IEJvb2xlYW5JbnB1dCkge1xuICAgIHRoaXMuX3RvZ2dsZU9uVGl0bGVDbGljayA9IGNvZXJjZUJvb2xlYW5Qcm9wZXJ0eSh2YWx1ZSk7XG4gIH1cbiAgcHJpdmF0ZSBfdG9nZ2xlT25UaXRsZUNsaWNrID0gZmFsc2U7XG5cbiAgcHJpdmF0ZSBfZXhwYW5kQWxsID0gZmFsc2U7XG4gIGNoZWNrZWRWYWx1ZXM6IHN0cmluZ1tdID0gW107XG4gIHRvZ2dsZTogYW55ID0ge307XG5cbiAgY29uc3RydWN0b3IocHJpdmF0ZSBfY2RSZWY6IENoYW5nZURldGVjdG9yUmVmKSB7fVxuXG4gIG5nT25Jbml0KCkge1xuICAgIGlmICh0aGlzLm5vZGVzICYmIHRoaXMubm9kZXMuZW50cmllcygpKSB7XG4gICAgICB0aGlzLl9zZXRJbml0aWFsQ2hlY2tlZEtleXMoKTtcbiAgICB9XG4gIH1cblxuICB0b2dnbGVFeHBhbmRBbGwoKSB7XG4gICAgaWYgKHRoaXMuX2V4cGFuZEFsbCkge1xuICAgICAgdGhpcy5leHBhbmRBbGxOb2RlcygpO1xuICAgIH0gZWxzZSBpZiAoIXRoaXMuX2V4cGFuZEFsbCkge1xuICAgICAgdGhpcy5jbG9zZUFsbE5vZGVzKCk7XG4gICAgfVxuICB9XG5cbiAgZXhwYW5kQWxsTm9kZXMoKSB7XG4gICAgZm9yIChjb25zdCBbaW5kZXgsIG5vZGVdIG9mIHRoaXMubm9kZXMuZW50cmllcygpKSB7XG4gICAgICBjb25zdCBpZHggPSBpbmRleDtcbiAgICAgIHRoaXMudG9nZ2xlW2lkeF0gPSB0cnVlO1xuICAgICAgaWYgKG5vZGVbdGhpcy5jaGlsZHJlbkZpZWxkXSAmJiBub2RlW3RoaXMuY2hpbGRyZW5GaWVsZF0ubGVuZ3RoID4gMCkge1xuICAgICAgICB0aGlzLl9leHBhbmRBbGxDaGlsZHJlbihub2RlLCBpZHgpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGNsb3NlQWxsTm9kZXMoKSB7XG4gICAgZm9yIChjb25zdCBbaW5kZXgsIG5vZGVdIG9mIHRoaXMubm9kZXMuZW50cmllcygpKSB7XG4gICAgICBjb25zdCBpZHggPSBpbmRleDtcbiAgICAgIHRoaXMudG9nZ2xlW2lkeF0gPSBmYWxzZTtcbiAgICAgIGlmIChub2RlW3RoaXMuY2hpbGRyZW5GaWVsZF0gJiYgbm9kZVt0aGlzLmNoaWxkcmVuRmllbGRdLmxlbmd0aCA+IDApIHtcbiAgICAgICAgdGhpcy5fY2xvc2VBbGxDaGlsZHJlbihub2RlLCBpZHgpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgX2V4cGFuZEFsbENoaWxkcmVuKG5vZGU6IGFueSwgaWR4OiBzdHJpbmcpIHtcbiAgICBmb3IgKGNvbnN0IFtjaGlsZEluZGV4LCBjaGlsZE5vZGVdIG9mIG5vZGVbdGhpcy5jaGlsZHJlbkZpZWxkXS5lbnRyaWVzKCkpIHtcbiAgICAgIGNvbnN0IGNoaWxkSWR4ID0gaWR4ICsgJ18nICsgY2hpbGRJbmRleDtcbiAgICAgIHRoaXMudG9nZ2xlW2NoaWxkSWR4XSA9IHRydWU7XG4gICAgICBpZiAoY2hpbGROb2RlW3RoaXMuY2hpbGRyZW5GaWVsZF0gJiYgY2hpbGROb2RlW3RoaXMuY2hpbGRyZW5GaWVsZF0ubGVuZ3RoID4gMCkge1xuICAgICAgICB0aGlzLl9leHBhbmRBbGxDaGlsZHJlbihjaGlsZE5vZGUsIGNoaWxkSWR4KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBwcml2YXRlIF9jbG9zZUFsbENoaWxkcmVuKG5vZGU6IGFueSwgaWR4OiBzdHJpbmcpIHtcbiAgICBmb3IgKGNvbnN0IFtjaGlsZEluZGV4LCBjaGlsZE5vZGVdIG9mIG5vZGVbdGhpcy5jaGlsZHJlbkZpZWxkXS5lbnRyaWVzKCkpIHtcbiAgICAgIGNvbnN0IGNoaWxkSWR4ID0gaWR4ICsgJ18nICsgY2hpbGRJbmRleDtcbiAgICAgIHRoaXMudG9nZ2xlW2NoaWxkSWR4XSA9IGZhbHNlO1xuICAgICAgaWYgKGNoaWxkTm9kZVt0aGlzLmNoaWxkcmVuRmllbGRdICYmIGNoaWxkTm9kZVt0aGlzLmNoaWxkcmVuRmllbGRdLmxlbmd0aCA+IDApIHtcbiAgICAgICAgdGhpcy5fY2xvc2VBbGxDaGlsZHJlbihjaGlsZE5vZGUsIGNoaWxkSWR4KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBwcml2YXRlIF9zZXRJbml0aWFsQ2hlY2tlZEtleXMoKSB7XG4gICAgZm9yIChjb25zdCBbaW5kZXgsIG5vZGVdIG9mIHRoaXMubm9kZXMuZW50cmllcygpKSB7XG4gICAgICBpZiAobm9kZVt0aGlzLmNoZWNrYm94ZXNGaWVsZF0pIHtcbiAgICAgICAgY29uc3QgaWR4ID0gaW5kZXg7XG4gICAgICAgIHRoaXMuY2hlY2tlZFZhbHVlcy5wdXNoKGlkeCk7XG4gICAgICAgIGlmIChub2RlW3RoaXMuY2hpbGRyZW5GaWVsZF0gJiYgbm9kZVt0aGlzLmNoaWxkcmVuRmllbGRdLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICB0aGlzLl9oYXNJbml0aWFsQ2hlY2tlZEtleXNDaGlsZHJlbihub2RlW3RoaXMuY2hpbGRyZW5GaWVsZF0sIGlkeCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBwcml2YXRlIF9oYXNJbml0aWFsQ2hlY2tlZEtleXNDaGlsZHJlbihjaGlsZHJlbk5vZGU6IGFueSwgaTogc3RyaW5nKSB7XG4gICAgZm9yIChjb25zdCBbY2hpbGRyZW5JZHgsIG5vZGVdIG9mIGNoaWxkcmVuTm9kZS5lbnRyaWVzKCkpIHtcbiAgICAgIGNvbnN0IGlkeCA9IGNoaWxkcmVuSWR4ICsgJ18nICsgaTtcblxuICAgICAgaWYgKG5vZGVbdGhpcy5jaGVja2JveGVzRmllbGRdKSB7XG4gICAgICAgIHRoaXMuY2hlY2tlZFZhbHVlcy5wdXNoKGlkeCk7XG4gICAgICB9XG4gICAgICBpZiAobm9kZVt0aGlzLmNoaWxkcmVuRmllbGRdICYmIG5vZGVbdGhpcy5jaGlsZHJlbkZpZWxkXS5sZW5ndGggPiAwKSB7XG4gICAgICAgIHRoaXMuX2hhc0luaXRpYWxDaGVja2VkS2V5c0NoaWxkcmVuKG5vZGVbdGhpcy5jaGlsZHJlbkZpZWxkXSwgaWR4KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICB0b2dnbGVCeU5vZGUoaTogc3RyaW5nKSB7XG4gICAgZm9yIChjb25zdCBbaW5kZXgsIG5vZGVdIG9mIHRoaXMubm9kZXMuZW50cmllcygpKSB7XG4gICAgICBpZiAobm9kZVt0aGlzLmNoaWxkcmVuRmllbGRdICYmIG5vZGVbdGhpcy5jaGlsZHJlbkZpZWxkXS5sZW5ndGggPiAwKSB7XG4gICAgICAgIGNvbnN0IGlkeCA9IGluZGV4O1xuICAgICAgICBjb25zdCB0b2dnbGVJZHggPSBpO1xuICAgICAgICBpZiAoaWR4ID09PSB0b2dnbGVJZHgpIHtcbiAgICAgICAgICB0aGlzLnRvZ2dsZVtpZHhdID0gIXRoaXMudG9nZ2xlW2lkeF07XG4gICAgICAgICAgdGhpcy5fY2RSZWYubWFya0ZvckNoZWNrKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5fY2hpbGRyZW5Ub2dnbGVCeU5vZGUobm9kZSwgaWR4LCB0b2dnbGVJZHgpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBfY2hpbGRyZW5Ub2dnbGVCeU5vZGUobm9kZTogYW55LCBpOiBzdHJpbmcsIHRvZ2dsZUlkeDogc3RyaW5nKSB7XG4gICAgZm9yIChjb25zdCBbY2hpbGRJbmRleCwgY2hpbGROb2RlXSBvZiBub2RlW3RoaXMuY2hpbGRyZW5GaWVsZF0uZW50cmllcygpKSB7XG4gICAgICBjb25zdCBub2RlSGFzQ2hpbGRyZW4gPVxuICAgICAgICBjaGlsZE5vZGVbdGhpcy5jaGlsZHJlbkZpZWxkXSAmJiBjaGlsZE5vZGVbdGhpcy5jaGlsZHJlbkZpZWxkXS5sZW5ndGggPiAwO1xuICAgICAgaWYgKG5vZGVIYXNDaGlsZHJlbikge1xuICAgICAgICBjb25zdCBpZHggPSBpICsgJ18nICsgY2hpbGRJbmRleDtcbiAgICAgICAgaWYgKGlkeCA9PT0gdG9nZ2xlSWR4KSB7XG4gICAgICAgICAgdGhpcy50b2dnbGVbaWR4XSA9ICF0aGlzLnRvZ2dsZVtpZHhdO1xuICAgICAgICAgIHRoaXMuX2NkUmVmLm1hcmtGb3JDaGVjaygpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMuX2NoaWxkcmVuVG9nZ2xlQnlOb2RlKGNoaWxkTm9kZSwgaWR4LCB0b2dnbGVJZHgpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgb25LZXlkb3duQ2hlY2tib3goZTogS2V5Ym9hcmRFdmVudCwgbm9kZTogYW55LCBpOiBhbnkpIHtcbiAgICBpZiAoZS5rZXlDb2RlID09PSBTUEFDRSB8fCBlLmtleUNvZGUgPT09IEVOVEVSKSB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB0aGlzLmNoZWNrTm9kZXMobm9kZSk7XG4gICAgICB0aGlzLnVwZGF0ZU5vZGVzQ2hlY2tlZFZhbHVlcyhub2RlLCBpKTtcbiAgICB9XG4gIH1cblxuICBvbktleWRvd24oZTogS2V5Ym9hcmRFdmVudCwgaTogYW55KSB7XG4gICAgaWYgKGUua2V5Q29kZSA9PT0gU1BBQ0UgfHwgZS5rZXlDb2RlID09PSBFTlRFUikge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy50b2dnbGVbaV0gPSAhdGhpcy50b2dnbGVbaV07XG4gICAgfVxuICB9XG5cbiAgY2hlY2tOb2Rlcyhub2RlOiBhbnkpIHtcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIG5vZGVbdGhpcy5jaGVja2JveGVzRmllbGRdID0gIW5vZGVbdGhpcy5jaGVja2JveGVzRmllbGRdO1xuICAgICAgdGhpcy5jaGVja2VkLmVtaXQobm9kZSk7XG4gICAgICB0aGlzLm5vZGVzQ2hhbmdlZC5lbWl0KHRoaXMubm9kZXMpO1xuICAgIH0sIDApO1xuICAgIGNvbnN0IG5vZGVIYXNDaGlsZHJlbiA9IG5vZGVbdGhpcy5jaGlsZHJlbkZpZWxkXSAmJiBub2RlW3RoaXMuY2hpbGRyZW5GaWVsZF0ubGVuZ3RoID4gMDtcbiAgICBpZiAobm9kZUhhc0NoaWxkcmVuKSB7XG4gICAgICB0aGlzLl9jaGVja0NoaWxkTm9kZXMobm9kZVt0aGlzLmNoaWxkcmVuRmllbGRdLCAhbm9kZVt0aGlzLmNoZWNrYm94ZXNGaWVsZF0pO1xuICAgIH1cbiAgICB0aGlzLl9jZFJlZi5tYXJrRm9yQ2hlY2soKTtcbiAgfVxuXG4gIHByaXZhdGUgX2NoZWNrQ2hpbGROb2RlcyhjaGlsZHJlbjogYW55LCBjaGVja2VkOiBib29sZWFuKSB7XG4gICAgY2hpbGRyZW4uZm9yRWFjaCgoY2hpbGROb2RlOiBhbnkpID0+IHtcbiAgICAgIGlmIChjaGlsZE5vZGVbdGhpcy5jaGVja2JveGVzRmllbGRdICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgY2hpbGROb2RlW3RoaXMuY2hlY2tib3hlc0ZpZWxkXSA9IGNoZWNrZWQ7XG4gICAgICAgIGNvbnN0IG5vZGVIYXNDaGlsZHJlbiA9XG4gICAgICAgICAgY2hpbGROb2RlW3RoaXMuY2hpbGRyZW5GaWVsZF0gJiYgY2hpbGROb2RlW3RoaXMuY2hpbGRyZW5GaWVsZF0ubGVuZ3RoID4gMDtcbiAgICAgICAgaWYgKG5vZGVIYXNDaGlsZHJlbikge1xuICAgICAgICAgIHRoaXMuX2NoZWNrQ2hpbGROb2RlcyhjaGlsZE5vZGVbdGhpcy5jaGlsZHJlbkZpZWxkXSwgY2hlY2tlZCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIHVwZGF0ZU5vZGVzQ2hlY2tlZFZhbHVlcyhub2RlOiBhbnksIGlkeDogYW55KSB7XG4gICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICBpZiAobm9kZVt0aGlzLmNoZWNrYm94ZXNGaWVsZF0gJiYgIXRoaXMuY2hlY2tlZFZhbHVlcy5pbmNsdWRlcyhpZHgpKSB7XG4gICAgICAgIHRoaXMuY2hlY2tlZFZhbHVlcy5wdXNoKGlkeCk7XG4gICAgICB9IGVsc2UgaWYgKCFub2RlW3RoaXMuY2hlY2tib3hlc0ZpZWxkXSAmJiB0aGlzLmNoZWNrZWRWYWx1ZXMuaW5jbHVkZXMoaWR4KSkge1xuICAgICAgICBjb25zdCByZW1vdmVJbmRleCA9IHRoaXMuY2hlY2tlZFZhbHVlcy5maW5kSW5kZXgoKGUpID0+IGUgPT09IGlkeCk7XG5cbiAgICAgICAgaWYgKHJlbW92ZUluZGV4ICE9PSAtMSkge1xuICAgICAgICAgIHRoaXMuY2hlY2tlZFZhbHVlcy5zcGxpY2UocmVtb3ZlSW5kZXgsIDEpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBjb25zdCBub2RlSGFzQ2hpbGRyZW4gPSBub2RlW3RoaXMuY2hpbGRyZW5GaWVsZF0gJiYgbm9kZVt0aGlzLmNoaWxkcmVuRmllbGRdLmxlbmd0aCA+IDA7XG4gICAgICBpZiAobm9kZUhhc0NoaWxkcmVuKSB7XG4gICAgICAgIHRoaXMuX3VwZGF0ZUNoaWxkTm9kZXNDaGVja2VkVmFsdWVzKG5vZGVbdGhpcy5jaGlsZHJlbkZpZWxkXSwgaWR4KTtcbiAgICAgIH1cbiAgICAgIHRoaXMuY2hlY2tlZEtleXMuZW1pdCh0aGlzLmNoZWNrZWRWYWx1ZXMpO1xuICAgIH0sIDApO1xuICB9XG5cbiAgcHJpdmF0ZSBfdXBkYXRlQ2hpbGROb2Rlc0NoZWNrZWRWYWx1ZXMoY2hpbGRyZW5Ob2RlOiBhbnksIGNoaWxkcmVuSWR4OiBzdHJpbmcpIHtcbiAgICBmb3IgKGNvbnN0IFtpbmRleCwgbm9kZV0gb2YgY2hpbGRyZW5Ob2RlLmVudHJpZXMoKSkge1xuICAgICAgY29uc3QgaWR4ID0gY2hpbGRyZW5JZHggKyAnXycgKyBpbmRleDtcblxuICAgICAgaWYgKG5vZGVbdGhpcy5jaGVja2JveGVzRmllbGRdICYmICF0aGlzLmNoZWNrZWRWYWx1ZXMuaW5jbHVkZXMoaWR4KSkge1xuICAgICAgICB0aGlzLmNoZWNrZWRWYWx1ZXMucHVzaChpZHgpO1xuICAgICAgfSBlbHNlIGlmICghbm9kZVt0aGlzLmNoZWNrYm94ZXNGaWVsZF0gJiYgdGhpcy5jaGVja2VkVmFsdWVzLmluY2x1ZGVzKGlkeCkpIHtcbiAgICAgICAgY29uc3QgcmVtb3ZlSW5kZXggPSB0aGlzLmNoZWNrZWRWYWx1ZXMuZmluZEluZGV4KChlKSA9PiBlID09PSBpZHgpO1xuICAgICAgICBpZiAocmVtb3ZlSW5kZXggIT09IC0xKSB7XG4gICAgICAgICAgdGhpcy5jaGVja2VkVmFsdWVzLnNwbGljZShyZW1vdmVJbmRleCwgMSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGNvbnN0IG5vZGVIYXNDaGlsZHJlbiA9IG5vZGVbdGhpcy5jaGlsZHJlbkZpZWxkXSAmJiBub2RlW3RoaXMuY2hpbGRyZW5GaWVsZF0ubGVuZ3RoID4gMDtcbiAgICAgIGlmIChub2RlSGFzQ2hpbGRyZW4pIHtcbiAgICAgICAgdGhpcy5fdXBkYXRlQ2hpbGROb2Rlc0NoZWNrZWRWYWx1ZXMobm9kZVt0aGlzLmNoaWxkcmVuRmllbGRdLCBpZHgpO1xuICAgICAgfVxuICAgIH1cbiAgfVxufVxuIiwiPCEtLSBjaGlsZCBub2RlcyAtLT5cbjxuZy10ZW1wbGF0ZSAjdHJlZSBsZXQtbm9kZUNoaWxkcmVuIGxldC1pZHg9XCJpZHhcIj5cbiAgPHVsIGNsYXNzPVwibWRiLXRyZWUtbGlzdFwiPlxuICAgIDxsaSAqbmdGb3I9XCJsZXQgbm9kZSBvZiBub2RlQ2hpbGRyZW47IGxldCBuID0gaW5kZXhcIiBjbGFzcz1cIm1kYi10cmVlLWxpc3Qtbm9kZVwiPlxuICAgICAgPGRpdiBjbGFzcz1cIm1kYi10cmVlLWNvbnRhaW5lclwiPlxuICAgICAgICA8ZGl2ICpuZ0lmPVwibm9kZVtjaGlsZHJlbkZpZWxkXSAmJiBub2RlW2NoaWxkcmVuRmllbGRdLmxlbmd0aCA+IDA7IGVsc2UgZW1wdHlJY29uXCI+XG4gICAgICAgICAgPHNwYW4gY2xhc3M9XCJtZGItdHJlZS1pY29uLWNvbnRhaW5lclwiPlxuICAgICAgICAgICAgPGlcbiAgICAgICAgICAgICAgdGFiaW5kZXg9XCIxXCJcbiAgICAgICAgICAgICAgYXJpYS1oaWRkZW49XCJ0cnVlXCJcbiAgICAgICAgICAgICAgW25nQ2xhc3NdPVwiXG4gICAgICAgICAgICAgICAgdG9nZ2xlW2lkeCArICdfJyArIG5dID8gJ21kYi10cmVlLXJvdGF0ZS1pY29uLW9wZW4nIDogJ21kYi10cmVlLXJvdGF0ZS1pY29uLWNsb3NlZCdcbiAgICAgICAgICAgICAgXCJcbiAgICAgICAgICAgICAgKGtleWRvd24pPVwib25LZXlkb3duKCRldmVudCwgaWR4ICsgJ18nICsgbilcIlxuICAgICAgICAgICAgICAoY2xpY2spPVwidG9nZ2xlW2lkeCArICdfJyArIG5dID0gIXRvZ2dsZVtpZHggKyAnXycgKyBuXVwiXG4gICAgICAgICAgICAgIGNsYXNzPVwibWRiLXRyZWUtaW5kaWNhdG9yIFwiXG4gICAgICAgICAgICA+PC9pPlxuICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxuZy10ZW1wbGF0ZSAjZW1wdHlJY29uXG4gICAgICAgICAgPjxzcGFuIGNsYXNzPVwibWRiLXRyZWUtaWNvbi1jb250YWluZXJcIlxuICAgICAgICAgICAgPjxpIGNsYXNzPVwibWRiLXRyZWUtZW1wdHktaWNvblwiIHN0eWxlPVwiZGlzcGxheTogYmxvY2tcIiBhcmlhLWhpZGRlbj1cInRydWVcIj48L2lcbiAgICAgICAgICA+PC9zcGFuPlxuICAgICAgICA8L25nLXRlbXBsYXRlPlxuICAgICAgICA8ZGl2XG4gICAgICAgICAgY2xhc3M9XCJtZGItdHJlZS1jaGVja2JveC1jb250YWluZXJcIlxuICAgICAgICAgICpuZ0lmPVwiY2hlY2tib3hlcyAmJiBub2RlW2NoZWNrYm94ZXNGaWVsZF0gIT09IHVuZGVmaW5lZFwiXG4gICAgICAgID5cbiAgICAgICAgICA8bWRiLWNoZWNrYm94XG4gICAgICAgICAgICBjbGFzcz1cImNoZWNrYm94LWZpbGxlZFwiXG4gICAgICAgICAgICBbZmlsbGVkSW5dPVwidHJ1ZVwiXG4gICAgICAgICAgICBbdGFiSW5kZXhdPVwiMVwiXG4gICAgICAgICAgICBbYXR0ci5pZF09XCJub2RlW3RleHRGaWVsZF1cIlxuICAgICAgICAgICAgKGtleWRvd24pPVwib25LZXlkb3duQ2hlY2tib3goJGV2ZW50LCBub2RlLCBpZHggKyAnXycgKyBuKVwiXG4gICAgICAgICAgICAoY2xpY2spPVwiY2hlY2tOb2Rlcyhub2RlKTsgdXBkYXRlTm9kZXNDaGVja2VkVmFsdWVzKG5vZGUsIGlkeCArICdfJyArIG4pXCJcbiAgICAgICAgICAgIFtjaGVja2VkXT1cIm5vZGVbY2hlY2tib3hlc0ZpZWxkXVwiXG4gICAgICAgICAgPjwvbWRiLWNoZWNrYm94PlxuICAgICAgICA8L2Rpdj5cbiAgICAgICAgPGRpdiAqbmdJZj1cImNoZWNrYm94ZXMgJiYgbm9kZVtjaGVja2JveGVzRmllbGRdID09PSB1bmRlZmluZWRcIj5cbiAgICAgICAgICA8ZGl2IGNsYXNzPVwibWRiLXRyZWUtY2hlY2tib3gtbnVsbC1jb250YWluZXJcIj48L2Rpdj5cbiAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgPGRpdlxuICAgICAgICAgICpuZ0lmPVwidG9nZ2xlT25UaXRsZUNsaWNrXCJcbiAgICAgICAgICBjbGFzcz1cIm1kYi10cmVlLXRleHQtZmllbGRcIlxuICAgICAgICAgIFtuZ1N0eWxlXT1cIntcbiAgICAgICAgICAgIGN1cnNvcjogbm9kZVtjaGlsZHJlbkZpZWxkXSAmJiBub2RlW2NoaWxkcmVuRmllbGRdLmxlbmd0aCA+IDAgPyAncG9pbnRlcicgOiAnZGVmYXVsdCdcbiAgICAgICAgICB9XCJcbiAgICAgICAgICAoY2xpY2spPVwidG9nZ2xlW2lkeCArICdfJyArIG5dID0gIXRvZ2dsZVtpZHggKyAnXycgKyBuXVwiXG4gICAgICAgID5cbiAgICAgICAgICB7eyBub2RlW3RleHRGaWVsZF0gfX1cbiAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgPGRpdiAqbmdJZj1cIiF0b2dnbGVPblRpdGxlQ2xpY2tcIiBjbGFzcz1cIm1kYi10cmVlLXRleHQtZmllbGQgbWRiLXRyZWUtdGV4dC1lbGxpcHNpc1wiPlxuICAgICAgICAgIHt7IG5vZGVbdGV4dEZpZWxkXSB9fVxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvZGl2PlxuICAgICAgPGRpdiAqbmdJZj1cIm5vZGVbY2hpbGRyZW5GaWVsZF0gJiYgdG9nZ2xlW2lkeCArICdfJyArIG5dXCI+XG4gICAgICAgIDxuZy1jb250YWluZXJcbiAgICAgICAgICAqbmdUZW1wbGF0ZU91dGxldD1cInRyZWU7IGNvbnRleHQ6IHsgJGltcGxpY2l0OiBub2RlW2NoaWxkcmVuRmllbGRdLCBpZHg6IGlkeCArICdfJyArIG4gfVwiXG4gICAgICAgID48L25nLWNvbnRhaW5lcj5cbiAgICAgIDwvZGl2PlxuICAgIDwvbGk+XG4gIDwvdWw+XG48L25nLXRlbXBsYXRlPlxuPCEtLSBmaXJzdCBub2RlcyAtLT5cbjx1bCBjbGFzcz1cIm1kYi10cmVlLWxpc3RcIj5cbiAgPGxpICpuZ0Zvcj1cImxldCBub2RlIG9mIG5vZGVzOyBsZXQgaSA9IGluZGV4XCIgY2xhc3M9XCJtZGItdHJlZS1saXN0LW5vZGVcIj5cbiAgICA8ZGl2IGNsYXNzPVwibWRiLXRyZWUtY29udGFpbmVyXCI+XG4gICAgICA8ZGl2ICpuZ0lmPVwibm9kZVtjaGlsZHJlbkZpZWxkXSAmJiBub2RlW2NoaWxkcmVuRmllbGRdLmxlbmd0aCA+IDA7IGVsc2UgZW1wdHlJY29uXCI+XG4gICAgICAgIDxzcGFuIGNsYXNzPVwibWRiLXRyZWUtaWNvbi1jb250YWluZXJcIj5cbiAgICAgICAgICA8aVxuICAgICAgICAgICAgdGFiaW5kZXg9XCIxXCJcbiAgICAgICAgICAgIGFyaWEtaGlkZGVuPVwidHJ1ZVwiXG4gICAgICAgICAgICBbbmdDbGFzc109XCJ0b2dnbGVbaV0gPyAnbWRiLXRyZWUtcm90YXRlLWljb24tb3BlbicgOiAnbWRiLXRyZWUtcm90YXRlLWljb24tY2xvc2VkJ1wiXG4gICAgICAgICAgICAoa2V5ZG93bik9XCJvbktleWRvd24oJGV2ZW50LCBpKVwiXG4gICAgICAgICAgICAoY2xpY2spPVwidG9nZ2xlW2ldID0gIXRvZ2dsZVtpXVwiXG4gICAgICAgICAgICBjbGFzcz1cIm1kYi10cmVlLWluZGljYXRvclwiXG4gICAgICAgICAgPjwvaT5cbiAgICAgICAgPC9zcGFuPlxuICAgICAgPC9kaXY+XG4gICAgICA8bmctdGVtcGxhdGUgI2VtcHR5SWNvblxuICAgICAgICA+PHNwYW4gY2xhc3M9XCJtZGItdHJlZS1pY29uLWNvbnRhaW5lclwiXG4gICAgICAgICAgPjxpIGNsYXNzPVwibWRiLXRyZWUtZW1wdHktaWNvblwiIHN0eWxlPVwiZGlzcGxheTogYmxvY2tcIiBhcmlhLWhpZGRlbj1cInRydWVcIj48L2lcbiAgICAgICAgPjwvc3Bhbj5cbiAgICAgIDwvbmctdGVtcGxhdGU+XG4gICAgICA8ZGl2XG4gICAgICAgIGNsYXNzPVwibWRiLXRyZWUtY2hlY2tib3gtY29udGFpbmVyXCJcbiAgICAgICAgKm5nSWY9XCJjaGVja2JveGVzICYmIG5vZGVbY2hlY2tib3hlc0ZpZWxkXSAhPT0gdW5kZWZpbmVkXCJcbiAgICAgID5cbiAgICAgICAgPG1kYi1jaGVja2JveFxuICAgICAgICAgIGNsYXNzPVwiY2hlY2tib3gtZmlsbGVkXCJcbiAgICAgICAgICBbY2hlY2tlZF09XCJub2RlW2NoZWNrYm94ZXNGaWVsZF1cIlxuICAgICAgICAgIFtmaWxsZWRJbl09XCJ0cnVlXCJcbiAgICAgICAgICBbdGFiSW5kZXhdPVwiMVwiXG4gICAgICAgICAgW2F0dHIuaWRdPVwibm9kZVt0ZXh0RmllbGRdXCJcbiAgICAgICAgICAoa2V5ZG93bik9XCJvbktleWRvd25DaGVja2JveCgkZXZlbnQsIG5vZGUsIGkpXCJcbiAgICAgICAgICAoY2xpY2spPVwiY2hlY2tOb2Rlcyhub2RlKTsgdXBkYXRlTm9kZXNDaGVja2VkVmFsdWVzKG5vZGUsIGkpXCJcbiAgICAgICAgPjwvbWRiLWNoZWNrYm94PlxuICAgICAgPC9kaXY+XG4gICAgICA8ZGl2ICpuZ0lmPVwiY2hlY2tib3hlcyAmJiBub2RlW2NoZWNrYm94ZXNGaWVsZF0gPT09IHVuZGVmaW5lZFwiPlxuICAgICAgICA8ZGl2IGNsYXNzPVwibWRiLXRyZWUtY2hlY2tib3gtbnVsbC1jb250YWluZXJcIj48L2Rpdj5cbiAgICAgIDwvZGl2PlxuXG4gICAgICA8ZGl2XG4gICAgICAgICpuZ0lmPVwidG9nZ2xlT25UaXRsZUNsaWNrXCJcbiAgICAgICAgY2xhc3M9XCJtZGItdHJlZS10ZXh0LWZpZWxkXCJcbiAgICAgICAgW25nU3R5bGVdPVwie1xuICAgICAgICAgIGN1cnNvcjogbm9kZVtjaGlsZHJlbkZpZWxkXSAmJiBub2RlW2NoaWxkcmVuRmllbGRdLmxlbmd0aCA+IDAgPyAncG9pbnRlcicgOiAnZGVmYXVsdCdcbiAgICAgICAgfVwiXG4gICAgICAgIChjbGljayk9XCJ0b2dnbGVbaV0gPSAhdG9nZ2xlW2ldXCJcbiAgICAgID5cbiAgICAgICAge3sgbm9kZVt0ZXh0RmllbGRdIH19XG4gICAgICA8L2Rpdj5cblxuICAgICAgPGRpdiAqbmdJZj1cIiF0b2dnbGVPblRpdGxlQ2xpY2tcIiBjbGFzcz1cIm1kYi10cmVlLXRleHQtZmllbGQgbWRiLXRyZWUtdGV4dC1lbGxpcHNpc1wiPlxuICAgICAgICB7eyBub2RlW3RleHRGaWVsZF0gfX1cbiAgICAgIDwvZGl2PlxuICAgIDwvZGl2PlxuICAgIDxkaXYgKm5nSWY9XCJub2RlW2NoaWxkcmVuRmllbGRdICYmIHRvZ2dsZVtpXVwiPlxuICAgICAgPG5nLWNvbnRhaW5lclxuICAgICAgICAqbmdUZW1wbGF0ZU91dGxldD1cInRyZWU7IGNvbnRleHQ6IHsgJGltcGxpY2l0OiBub2RlW2NoaWxkcmVuRmllbGRdLCBpZHg6IGkgfVwiXG4gICAgICA+PC9uZy1jb250YWluZXI+XG4gICAgPC9kaXY+XG4gIDwvbGk+XG48L3VsPlxuIl19